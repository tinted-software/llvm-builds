# TODO: re-enable libclc once 'Target "clang" is not an executable or library.' is solved
set(LLVM_ENABLE_PROJECTS "mlir;bolt;polly;clang;lld;clang-tools-extra;lldb" CACHE STRING "")
set(LLVM_RUNTIME_TARGETS "x86_64-unknown-linux-gnu" CACHE STRING "")
set(LLVM_EXPERIMENTAL_TARGETS_TO_BUILD "all" CACHE STRING "")
set(CLANG_ENABLE_HLSL ON CACHE BOOL "")
set(CLANG_ENABLE_CIR ON CACHE BOOL "")
set(LLVM_INSTALL_UTILS ON CACHE BOOL "")
set(MLIR_ENABLE_VULKAN_RUNNER OFF CACHE BOOL "")
set(MLIR_ENABLE_BINDINGS_PYTHON OFF CACHE BOOL "")
set(LLVM_INCLUDE_TESTS OFF CACHE BOOL "")
set(LLVM_ENABLE_TERMINFO OFF CACHE BOOL "")
set(LLDB_ENABLE_LIBEDIT OFF CACHE BOOL "")
set(LLDB_ENABLE_CURSES OFF CACHE BOOL "")
set(LLDB_ENABLE_LIBXML2 OFF CACHE BOOL "")
set(LLDB_ENABLE_PYTHON OFF CACHE BOOL "")
set(LLDB_ENABLE_LUA OFF CACHE BOOL "")
set(LLDB_ENABLE_LZMA OFF CACHE BOOL "")
set(LLVM_CCACHE_BUILD ON CACHE BOOL "")
set(CLANG_DEFAULT_UNWINDLIB libunwind CACHE BOOL "")
set(CLANG_DEFAULT_CXX_STDLIB libc++ CACHE BOOL "")
set(CLANG_DEFAULT_LINKER lld CACHE BOOL "")
set(CLANG_DEFAULT_OBJCOPY llvm-objcopy CACHE BOOL "")
set(CLANG_DEFAULT_RTLIB compiler-rt CACHE BOOL "")
set(CLANG_PLUGIN_SUPPORT ON CACHE BOOL "")
set(LLVM_ENABLE_LIBXML2 OFF CACHE BOOL "")
set(LLVM_ENABLE_LLD ON CACHE BOOL "")
set(LLVM_ENABLE_LIBCXX ON CACHE BOOL "")

# ThinLTO + Dylib
# TODO: thin lto takes forever on a ryzen 9600x, consider improving lld link times based on mold and wild???
set(LLVM_ENABLE_LTO OFF CACHE BOOL "")
set(LLVM_USE_SPLIT_DWARF ON CACHE BOOL "")
set(BUILD_SHARED_LIBS ON CACHE BOOL "")
# TODO: enable driver build, currently breaks libclc
set(LLVM_TOOL_LLVM_DRIVER_BUILD OFF CACHE BOOL "")
set(LLVM_ENABLE_PIC ON CACHE BOOL "")

# Runtimes
set(LLVM_ENABLE_RUNTIMES "compiler-rt;libcxx;libcxxabi;libunwind;libc;openmp;libclc" CACHE STRING "")
set(RUNTIMES_x86_64-unknown-linux-gnu_LIBCXX_INSTALL_MODULES ON CACHE BOOL "")
set(RUNTIMES_x86_64-unknown-linux-gnu_LIBCXX_ENABLE_STATIC_ABI_LIBRARY OFF CACHE BOOL "")
set(RUNTIMES_x86_64-unknown-linux-gnu_LIBCXX_USE_COMPILER_RT ON CACHE BOOL "")
set(RUNTIMES_x86_64-unknown-linux-gnu_LIBCXX_USE_COMPILER_RT ON CACHE BOOL "")
set(RUNTIMES_x86_64-unknown-linux-gnu_LIBCXX_ENABLE_SHARED ON CACHE BOOL "")
set(RUNTIMES_x86_64-unknown-linux-gnu_LIBCXX_HAS_GCC_LIB OFF CACHE BOOL "")
set(RUNTIMES_x86_64-unknown-linux-gnu_LIBCXX_HAS_GCC_LIB OFF CACHE BOOL "")
set(RUNTIMES_x86_64-unknown-linux-gnu_LIBCXX_HAS_GCC_S_LIB OFF CACHE BOOL "")
set(RUNTIMES_x86_64-unknown-linux-gnu_LIBCXX_HAS_ATOMIC_LIB OFF CACHE BOOL "")
set(RUNTIMES_x86_64-unknown-linux-gnu_LIBCXX_STATICALLY_LINK_ABI_IN_STATIC_LIBRARY OFF CACHE BOOL "")
set(RUNTIMES_x86_64-unknown-linux-gnu_LIBUNWIND_ENABLE_SHARED ON CACHE BOOL "")
set(RUNTIMES_x86_64-unknown-linux-gnu_LIBUNWIND_USE_COMPILER_RT ON CACHE BOOL "")
set(RUNTIMES_x86_64-unknown-linux-gnu_LIBUNWIND_INSTALL_HEADERS ON CACHE BOOL "")
set(RUNTIMES_x86_64-unknown-linux-gnu_LIBCXXABI_ENABLE_SHARED ON CACHE BOOL "")
set(RUNTIMES_x86_64-unknown-linux-gnu_LIBCXXABI_USE_COMPILER_RT ON CACHE BOOL "")
set(RUNTIMES_x86_64-unknown-linux-gnu_LIBCXXABI_USE_LLVM_UNWINDER ON CACHE BOOL "")
set(RUNTIMES_x86_64-unknown-linux-gnu_LIBCXXABI_ENABLE_STATIC_UNWINDER OFF CACHE BOOL "")
set(RUNTIMES_x86_64-unknown-linux-gnu_COMPILER_RT_USE_BUILTINS_LIBRARY ON CACHE BOOL "")
set(RUNTIMES_x86_64-unknown-linux-gnu_COMPILER_RT_HAS_GCC_S_LIB OFF CACHE BOOL "")
